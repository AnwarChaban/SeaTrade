<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
</head>
<style>
    table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }
    
    td, th {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
    }
    
    th {
      background-color: #dddddd;
    }
    </style>
<body>

    <h1>Company</h1>
    
    <!-- <form action="http://localhost:8082/getCompany" method="get" id="companyForm">
        <p>Company Name: <input type="text" id="companyName"></p>
        
        <input type="submit" value="Submit">
    </form> -->

    <script>
        window.onload = function() {
            getCompany('http://localhost:8082/getCompany');
        };
        </script>
    <!-- <button onclick = "getCompany('http://localhost:8082/getCompany')" > Click Me </button> -->
    <table id="data-table">
        <tr>
            <th>Id</th>
            <th>Companyname</th>
            <th>Guthaben</th>
        </tr> 

    </table>
    
    <script>
        async function getCompany (url) {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", url);
            xhr.send();
            xhr.onload = () => {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    const data = xhr.response;
                    const dataArray = data.split(';'); // Split the data by semicolon

                    // Get the table or create one if it doesn't exist
                    let table = document.getElementById('data-table');
                    

                    dataArray.forEach(item => {
                        let itemArray = item.split(','); // Split the item by comma
                        let tr = document.createElement('tr');

                        itemArray.forEach((subItem, index)  => {
                            let td = document.createElement('td');
                            td.innerText = subItem;
                            if (index==1)
                            {
                                td.id = subItem;
                            }
                            if (index==0)
                            {
                                td.style.cursor = 'pointer';
                                td.id = subItem;
                                td.onclick = function() {
                                let secondTdValue = this.parentNode.children[0].innerText;
                                window.open('ship.html/getShips?companyId='+secondTdValue);
                            }
                            };
                            tr.appendChild(td);
                        });

                        table.appendChild(tr);
                    });

                    console.log(data);
                } else {
                    console.log(`Error: ${xhr.status}`);
                }
            };
        }
        async function fetchAsync (url) {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", url);
            xhr.send();
            xhr.onload = () => {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    const data = xhr.response;
                    console.log(data);
                } else {
                    console.log('"Error: ${xhr.status}');
                }
            };
        }
    </script>
</body>
</html>